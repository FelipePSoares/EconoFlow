<div class="dropdown">
  <button class="btn btn-outline-secondary position-relative"
          type="button"
          id="dropdownNotifications"
          data-bs-toggle="dropdown"
          aria-expanded="false">
    <i class="bi bi-bell"></i>
    @if (((unreadCount$ | async) ?? 0) > 0) {
    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
      {{ unreadCount$ | async }}
      <span class="visually-hidden">{{ 'UnreadNotifications' | translate }}</span>
    </span>
    }
  </button>

  <div class="dropdown-menu dropdown-menu-end shadow border-0 notifications-dropdown"
       aria-labelledby="dropdownNotifications">
    <div class="dropdown-header d-flex justify-content-between align-items-center">
      <h6 class="mb-0">
        <i class="bi bi-bell me-2"></i>
        {{ 'Notifications' | translate }}
      </h6>
    </div>

    <div class="notifications-list">
      @if (((unreadCount$ | async) ?? 0) === 0) {
      <div class="text-center py-4 text-muted">
        <i class="bi bi-bell-slash fs-1 d-block mb-2"></i>
        <p class="mb-0">{{ 'NoNotifications' | translate }}</p>
      </div>
      } @else {
      @for (notification of (notifications$ | async); track notification.id) {
      <div class="dropdown-item notification-item"
           (click)="$event.stopPropagation()">
        <div class="d-flex">
          <div class="notification-icon me-3">
            @switch (notification.category) {
            @case ('System') {
            <i class="bi bi-gear-fill text-primary"></i>
            }
            @case ('Finance') {
            <i class="bi bi-cash-coin text-success"></i>
            }
            @case ('Security') {
            <i class="bi bi-shield-fill-exclamation text-warning"></i>
            }
            @case ('Collaboration') {
            <i class="bi bi-people-fill text-info"></i>
            }
            @default {
            <i class="bi bi-bell-fill text-secondary"></i>
            }
            }
          </div>
          <div class="notification-content flex-grow-1">
            <p class="notification-message mb-1">{{ notification.codeMessage  | translate }}</p>
            <div class="notification-actions d-flex gap-2 align-items-center">
              @if (notification.actionLabelCode){
              <button class="btn btn-sm btn-outline-primary"
                      (click)="action(notification.type)"
                      [title]="notification.actionLabelCode | translate">
                <i class="bi bi-box-arrow-up-right me-1"></i>
                {{ notification.actionLabelCode  | translate }}
              </button>
              }
              @if (!notification.isActionRequired) {
              <button class="btn btn-sm btn-outline-secondary"
                      (click)="markAsRead(notification.id)"
                      [title]="'SetAsRead' | translate">
                <i class="bi bi-check2"></i>
              </button>
              }
            </div>
          </div>
        </div>
      </div>
      }
      }
    </div>
  </div>
</div>
