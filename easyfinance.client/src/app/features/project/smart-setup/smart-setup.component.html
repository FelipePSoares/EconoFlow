<div class="container text-center">
  <div class="row justify-content-md-center" style="max-width: 500px;">
    <!-- Amount Field -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>{{ 'FieldAnnualIncome' | translate }}</mat-label>
      <input matInput
             type="text"
             inputmode="decimal"
             currencyMask
             [(ngModel)]="annualIncome"
             [options]="{ prefix: currencySymbol, allowNegative: false, thousands: thousandSeparator, decimal: decimalSeparator, precision: 0 }">
    </mat-form-field>

    <div *ngFor="let category of (categories$ | async); let i = index">
      <div class="d-flex justify-content-between align-items-center">
        <div>{{category.percentage}}% - {{ category.name }} - {{ (annualIncome / 12) * category.percentage / 100 | currencyFormat: true }}</div>
        <button mat-icon-button aria-label="Close" type="button" (click)="remove(category)">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      <mat-slider class="w-100"
                  [max]="100"
                  [min]="0"
                  [step]="1"
                  [displayWith]="formatLabel">
        <input matSliderThumb
               [(ngModel)]="category.percentage"
               (change)="calcularValores()">
      </mat-slider>
    </div>

    <div class="list-group-item text-center">
      <button class="btn btn-primary btn-add btn-lg w-100 d-flex justify-content-center align-items-center"
              (click)="add()">
        <fa-icon [icon]="faPlus" class="me-2"></fa-icon>
        {{ 'ButtonAddCategory' | translate }}
      </button>
    </div>

    <div [ngClass]="{'excedido': totalPercentage > 100, 'completo': totalPercentage === 100}">
      <strong>Total: {{totalPercentage}}%</strong>
      <div *ngIf="totalPercentage > 100" class="aviso">
        Atenção: O total excede 100%
      </div>
      <div *ngIf="totalPercentage < 100" class="aviso">
        Restante: {{100 - totalPercentage}}%
      </div>
      <div *ngIf="totalPercentage === 100" class="aviso sucesso">
        Distribuição completa!
      </div>
    </div>
    <div class="dialog-footer d-flex justify-content-end mt-4">
      <button mat-stroked-button type="button" class="me-2" (click)="cancel()">{{ 'ButtonSkipSmartSetup' | translate }}</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="totalPercentage > 100">{{ 'ButtonSave' | translate }}</button>
    </div>
  </div>
</div>
