<div class="container monthly-overview py-4">
  <div class="row justify-content-center">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4 overview-header">
        <app-return-button (returnButtonEvent)="previous()"></app-return-button>
        <h2 class="text-center flex-grow-1 m-0">{{ userProject.project.name }} - {{ 'MonthlyOverview' | translate }}</h2>
        <app-current-date (dateUpdatedEvent)="updateDate($event)"></app-current-date>
      </div>
    </div>
  </div>

  <div class="row mt-3">
    <div class="col-12 col-md-4">
      <div class="summary-card wrap p-3">
        <h3>{{ 'TotalExpenses' | translate }}</h3>
        <p class="value danger mb-0">{{ totalExpenses | currencyFormat: true }}</p>
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="summary-card wrap p-3">
        <h3>{{ 'TotalIncomes' | translate }}</h3>
        <p class="value success mb-0">{{ totalIncomes | currencyFormat: true }}</p>
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="summary-card wrap p-3">
        <h3>{{ 'Balance' | translate }}</h3>
        <p class="value mb-0" [ngClass]="balance < 0 ? 'danger' : 'success'">{{ balance | currencyFormat: true }}</p>
      </div>
    </div>
  </div>

  <div class="row mt-2">
    <div class="col-12">
      <div class="wrap p-3 charts-panel">
        <div class="row g-3">
          <div class="col-12 col-lg-6 chart-block">
            <h3 class="text-center mb-3">{{ 'CumulativeIncomeVsExpense' | translate }}</h3>
            @if (dailyIncomeExpenseChartData.datasets[0].data.length || dailyIncomeExpenseChartData.datasets[1].data.length || dailyIncomeExpenseChartData.datasets[2].data.length) {
              <div class="chart-container">
                <canvas
                  baseChart
                  [type]="'line'"
                  [data]="dailyIncomeExpenseChartData"
                  [options]="lineChartOptions">
                </canvas>
              </div>
            } @else {
              <p class="text-center text-secondary mb-0">{{ 'NoDataForSelectedMonth' | translate }}</p>
            }
          </div>
          <div class="col-12 col-lg-6 chart-block chart-block-divider">
            <h3 class="text-center mb-3">{{ 'ExpensesByCategory' | translate }}</h3>
            @if (expenseChartData.datasets[0].data.length) {
              <div class="chart-container">
                <canvas
                  baseChart
                  [type]="'doughnut'"
                  [data]="expenseChartData"
                  [options]="doughnutChartOptions">
                </canvas>
              </div>
            } @else {
              <p class="text-center text-secondary mb-0">{{ 'NoDataForSelectedMonth' | translate }}</p>
            }
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-2">
    <div class="col-12">
      <div class="wrap p-3">
        <h3 class="text-center mb-3">{{ 'TopExpenseCategories' | translate }}</h3>
        @if (expenseInsights.length) {
          <ul class="list-group list-group-flush">
            @for (item of expenseInsights; track item.name) {
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>{{ item.name }}</span>
                <span class="text-end">
                  <strong>{{ item.amount | currencyFormat: true }}</strong>
                  <span class="text-secondary ms-2">({{ item.percentage | number: '1.1-1' }}%)</span>
                </span>
              </li>
            }
          </ul>
        } @else {
          <p class="text-center text-secondary mb-0">{{ 'NoDataForSelectedMonth' | translate }}</p>
        }
      </div>
    </div>
  </div>
</div>
